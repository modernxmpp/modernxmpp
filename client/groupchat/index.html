<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        <link rel="canonical" href="https://docs.modernxmpp.org/client/groupchat/">
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>Multi-user Chats - Modern XMPP</title>
        <link href="../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css">
        <link href="../../css/modernxmpp.css" rel="stylesheet">

        <script src="../../js/jquery-1.10.2.min.js" defer></script>
        <script src="../../js/bootstrap.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="../..">Modern XMPP</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="navitem">
                                <a href="../.." class="nav-link">Home</a>
                            </li>
                            <li class="dropdown active">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Guidelines <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../design/" class="dropdown-item">User Interface</a>
</li>
                                    
<li>
    <a href="../protocol/" class="dropdown-item">Protocol</a>
</li>
                                    
<li>
    <a href="./" class="dropdown-item active">Multi-user Chats</a>
</li>
                                </ul>
                            </li>
                            <li class="navitem">
                                <a href="../../terminology/" class="nav-link">Terminology</a>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Projects <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../projects/portability/" class="dropdown-item">Account portability</a>
</li>
                                    
<li>
    <a href="../../projects/auth/" class="dropdown-item">Modern auth</a>
</li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../protocol/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../../terminology/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a href="https://github.com/modernxmpp/modernxmpp/edit/draft/docs/client/groupchat.md" class="nav-link"><i class="fa fa-github"></i> Edit on GitHub</a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="1"><a href="#multi-user-chats" class="nav-link">Multi-user Chats</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#types-of-chat" class="nav-link">Types of chat</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#user-nickname" class="nav-link">User nickname</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#bookmarks" class="nav-link">Bookmarks</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#private-messages" class="nav-link">Private messages</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="multi-user-chats">Multi-user Chats<a class="headerlink" href="#multi-user-chats" title="Permanent link">&para;</a></h1>
<h2 id="types-of-chat">Types of chat<a class="headerlink" href="#types-of-chat" title="Permanent link">&para;</a></h2>
<p>There are two kinds of multi-user chat. Private <em>group chats</em>, and public <em>channels</em><sup id="fnref:rationale-gc"><a class="footnote-ref" href="#fn:rationale-gc">1</a></sup>.</p>
<h3 id="properties">Properties<a class="headerlink" href="#properties" title="Permanent link">&para;</a></h3>
<p>To detect if a multi-user chat is a <em>group chat</em> or a <em>channel</em></p>
<table>
<thead>
<tr>
<th align="left"></th>
<th align="left">MUC Configuration variable (1)</th>
<th align="left">Group chat</th>
<th align="left">Disco Feature (2)</th>
<th align="left">Channel</th>
<th align="left">Disco Feature (2)</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">Persistent</td>
<td align="left">muc#roomconfig_persistentroom</td>
<td align="left">Yes</td>
<td align="left">muc_persistent</td>
<td align="left">Yes</td>
<td align="left">muc_persistent</td>
</tr>
<tr>
<td align="left">MAM enabled</td>
<td align="left"><strong>Prosody</strong> muc#roomconfig_enablearchiving<br><strong>ejabberd community</strong>: mam<br><strong>ejabberd saas</strong> muc#roomconfig_mam</td>
<td align="left">Yes</td>
<td align="left">urn:xmpp:mam:2</td>
<td align="left">Yes</td>
<td align="left">urn:xmpp:mam:2</td>
</tr>
<tr>
<td align="left">Subject editable</td>
<td align="left">muc#roomconfig_changesubject</td>
<td align="left">No</td>
<td align="left">muc#roomconfig_changesubject to <code>false</code></td>
<td align="left">No</td>
<td align="left">muc#roomconfig_changesubject to <code>false</code></td>
</tr>
<tr>
<td align="left">Members-only</td>
<td align="left">muc#roomconfig_membersonly</td>
<td align="left">Yes (3)</td>
<td align="left">muc_membersonly</td>
<td align="left">No</td>
<td align="left">muc_open</td>
</tr>
<tr>
<td align="left">JIDs revealed</td>
<td align="left">muc#roomconfig_whois</td>
<td align="left">Yes (3)</td>
<td align="left">muc_nonanonymous</td>
<td align="left">No</td>
<td align="left">muc_semianonymous</td>
</tr>
<tr>
<td align="left">Publicly listed</td>
<td align="left">muc#roomconfig_publicroom</td>
<td align="left">No  (3)</td>
<td align="left">muc_hidden</td>
<td align="left">Yes</td>
<td align="left">muc_public</td>
</tr>
<tr>
<td align="left">PMs</td>
<td align="left">muc#roomconfig_allowpm</td>
<td align="left">No  (3)</td>
<td align="left">muc#roomconfig_allowpm to <code>none</code></td>
<td align="left">Yes</td>
<td align="left">muc#roomconfig_allowpm to <code>anyone</code></td>
</tr>
</tbody>
</table>
<p>(1) As defined in <a href="https://xmpp.org/extensions/xep-0045.html#registrar-formtype-owner">XEP-0045: Multi-User Chat - 16.5.3</a></p>
<p>(2) As defined in <a href="https://xmpp.org/extensions/xep-0045.html#registrar-features">XEP-0045: Multi-User Chat - 16.3</a></p>
<p>(3) Immutable for <em>group chats</em>.</p>
<p>Options marked <code>(3) Immutable</code> should be used when creating group chats, and also as a means of detection. These options may be hidden or greyed out in a configuration dialog. The other options are recommendations.</p>
<h4 id="about-pms">About PMs<a class="headerlink" href="#about-pms" title="Permanent link">&para;</a></h4>
<p>While it is possible to entirely prevent PMs from being sent with
<a href="https://xmpp.org/extensions/xep-0045.html#privatemessage"><code>muc#roomconfig_allowpm</code></a>,
clients should prefer using JIDs when <code>muc#roomconfig_whois</code> is set to <code>anyone</code>.</p>
<p>In channels, if the initiating client has access to revealed JIDs (with
<code>muc#roomconfig_whois</code> set to <code>moderators</code>), clients may want to refrain from
using them to prevent disclosing the JID of the user initiating the chat,
unless the recipient already knows them from another venue (e.g., the
recipient is in their roster).</p>
<h3 id="terminology">Terminology<a class="headerlink" href="#terminology" title="Permanent link">&para;</a></h3>
<p>People in the <em>group chat</em> / <em>channel</em>: <em>Participants</em></p>
<p>Roles are not displayed and cannot be modified through the UI.</p>
<table>
<thead>
<tr>
<th align="left">Affiliations</th>
<th align="center">In group chats</th>
<th align="center">In channels</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">none</td>
<td align="center">N/A **</td>
<td align="center">Guest</td>
</tr>
<tr>
<td align="left">member</td>
<td align="center">-</td>
<td align="center">-</td>
</tr>
<tr>
<td align="left">admin</td>
<td align="center"><em>Admin</em> (*)</td>
<td align="center">Admin</td>
</tr>
<tr>
<td align="left">owner</td>
<td align="center">Owner</td>
<td align="center">Owner</td>
</tr>
</tbody>
</table>
<p>(*) A <em>group chat</em> will display an existing admin as such but it will not encourage/allow
someone to be promoted to admin. UI options in <em>group chats</em> only allow a member to become
an owner but not admin. So admins are discouraged by the UI but will be displayed as such
if they end up being one for some reason.</p>
<p>(**) Everybody is a member in <em>group chats</em></p>
<p>Clients MAY create an 'advanced view' that displays roles as well.</p>
<h2 id="user-nickname">User nickname<a class="headerlink" href="#user-nickname" title="Permanent link">&para;</a></h2>
<p>When joining a group chat, a client needs to select a nickname to use. There are multiple
sources from which this name may be selected. The client should use the following sources
in order:</p>
<dl>
<dt>Bookmark</dt>
<dd>If the chat is present in the user's bookmarks and has a nickname present (as the resource).</dd>
<dt>Reserved name</dt>
<dd>A chat <a href="https://xmpp.org/extensions/xep-0045.html#reservednick">may be queried</a> to fetch the
name that is registered by the user for that chat.</dd>
<dt>User nickname (PEP)</dt>
<dd>The name stored in the user's account according to
<a href="https://xmpp.org/extensions/xep-0172.html#manage">XEP-0172</a>.</dd>
<dt>User nickname (vCard)</dt>
<dd>The name stored in the user's vCard as <code>NICKNAME</code>.</dd>
<dt>Local nickname</dt>
<dd>(Optional, not recommended<sup id="fnref:local-nickname"><a class="footnote-ref" href="#fn:local-nickname">2</a></sup>) A nickname previously configured by the user in this client instance.</dd>
<dt>JID username</dt>
<dd>The username portion of the user's JID (i.e. before the '@').</dd>
</dl>
<h3 id="other-users-names">Other user's names<a class="headerlink" href="#other-users-names" title="Permanent link">&para;</a></h3>
<p>The display of other user's names is covered in the <a href="../design/#names">general UI recommendations</a>.</p>
<h2 id="bookmarks">Bookmarks<a class="headerlink" href="#bookmarks" title="Permanent link">&para;</a></h2>
<p>Figuring out which group chats to join is the client’s job. For that it
should store the list of group chats to rejoin automatically on the
server, named bookmarks. Three possible protocols exist for this:</p>
<ul>
<li><a href="https://xmpp.org/extensions/xep-0402.html">XEP-0402</a> which is the
  current preferred method</li>
<li><a href="https://xmpp.org/extensions/xep-0048.html">XEP-0048 1.1</a>, recently
  deprecated but still in use by some clients</li>
<li><a href="https://xmpp.org/extensions/attic/xep-0048-1.0.html">XEP-0048 1.0</a>,
  in wide use, based on
  <a href="https://xmpp.org/extensions/xep-0049.html">XEP-0049</a></li>
</ul>
<p>In order to see the same set of bookmarks as every other client the
user might be using, it is recommended to implement <strong>XEP-0048 1.0</strong> first
and foremost when the user's account may be shared with other clients.</p>
<p>This legacy protocol however doesn’t support notifications when the bookmarks
change due to another client or the server. To avoid this issue, a modern client
should also implement <strong>XEP-0402</strong> ("PEP Native Bookmarks"), but use it <em>only</em> if the account
advertises 'urn:xmpp:bookmarks:1#compat' (as defined in <a href="https://xmpp.org/extensions/xep-0402.html#compatibility">XEP-0402 paragraph 5.3
Compatibility</a>).</p>
<p>Implementing XEP-0048 1.1 is not recommended in modern clients.</p>
<p>The following table summarizes the implementation recommendations described in this section:</p>
<table>
<thead>
<tr>
<th>XEP</th>
<th>Implement</th>
<th>Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>XEP-0048 1.0<br>(Private XML storage)</td>
<td>Yes<br>(for backwards compatibility)</td>
<td>When <code>urn:xmpp:bookmarks:1#compat</code> <strong>is not</strong> advertised by the server on the user's account.</td>
</tr>
<tr>
<td>XEP-0048 1.1<br>(PEP storage, single-item)</td>
<td>No<br>(deprecated in favour of XEP-0402)</td>
<td>Never</td>
</tr>
<tr>
<td>XEP-0402<br>(PEP storage, multi-item)</td>
<td>Yes</td>
<td>When <code>urn:xmpp:bookmarks:1#compat</code> <strong>is</strong> advertised by the server on the user's account.</td>
</tr>
</tbody>
</table>
<h2 id="private-messages">Private messages<a class="headerlink" href="#private-messages" title="Permanent link">&para;</a></h2>
<p>Clients must always use real JIDs for messaging privately within a <em>group chat</em> if (and only if) JIDs are publicly visible to all participants.<sup id="fnref:pm-realjid"><a class="footnote-ref" href="#fn:pm-realjid">3</a></sup></p>
<!-- Footnotes -->

<div class="footnote">
<hr />
<ol>
<li id="fn:rationale-gc">
<p>Rationale <a href="/rationale#group-chats">group chats</a>&#160;<a class="footnote-backref" href="#fnref:rationale-gc" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
<li id="fn:local-nickname">
<p>To avoid requiring the user to configure a nickname manually on each device, shared cross-device stores such as PEP and vCard should be preferred.&#160;<a class="footnote-backref" href="#fnref:local-nickname" title="Jump back to footnote 2 in the text">&#8617;</a></p>
</li>
<li id="fn:pm-realjid">
<p>If real JIDs are known to all participants, it is preferable to use that for private communication to avoid confusion. Through-MUC PMs have the following disadvantages:</p>
<ul>
<li>Only work while connected to the group chat</li>
<li>Do not interact well with multiple devices (e.g. not all of a recipient's devices may be in a group chat)</li>
<li>Can cause confusion if talking to the same person through different views (e.g. if the person is already a contact in your roster, and you already have a chat open with them)</li>
</ul>
<p>However if the sending user is an admin of a room where JIDs are hidden, using a real JID will reveal the admin's private JID to the recipient. Either warn the sender that their JID will be revealed, or always use the in-room JID in such channels.&#160;<a class="footnote-backref" href="#fnref:pm-realjid" title="Jump back to footnote 3 in the text">&#8617;</a></p>
</li>
</ol>
</div></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
                <p>CC-BY-SA 4.0</p>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../js/base.js" defer></script>
        <script src="../../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
